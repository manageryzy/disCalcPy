# 需求说明书 #

不保证不修改（笑

## 需求模块 ##

* 客户端下载模块：在系统启动之后开始下载最新版客户端程序
* 服务端模块
* ……

## 需求功能列表 ##

* [网络自组织](#网络自组织)
* [服务端宕机处理](#服务端宕机处理)
* [批量添加计算任务](#批量添加计算任务)
* [动态添加或者移除计算节点](#动态添加或者移除计算节点)
* [计算节点掉线任务重分配](#计算节点掉线任务重分配)
* [计算暂停功能，要求能够在半个小时内终止计算（一个基本的计算迭代可能要数小时）](#计算暂停功能)
* [断点继续计算，服务器上保存断点的计算任务](#断点继续计算)
* [计算节点状态监控](#计算节点状态监控)
* [计算节点统一执行脚本](#计算节点统一执行脚本)
* [邮件提醒](#邮件提醒)
* [WEB管理界面](#WEB管理界面)
* [数据表格导出](#数据表格导出)
* [权值压缩打包下载](#权值压缩打包下载)

## 详细需求列表 ##

<a id="网络自组织"></a>
### 网络自组织

这个功能是最基本的，所有的客户端启动之后都会尝试请求服务器上的文件列表，然后下载服务端列表上的文件，并且执行其中的一个启动脚本。虽然现在防火墙不允许外网访问80口，但是还是不太希望让go的程序直接用80口。这里的列表还是用PHP来处理一下吧。让客户端先下载回来一个专用的下载器，由下载器再进行下载。


<a id="服务端宕机处理"></a>
### 服务端宕机处理

网络能够在服务器意外宕机的时候继续计算并且把结果保存在等待上传的队列里面，等服务器重启恢复之后服务器要有接收这些数据的功能。


<a id="批量添加计算任务"></a>
### 批量添加计算任务

在服务端的管理界面里面可以批量的添加计算任务，可以通过JSON来添加任务列表。


<a id="动态添加或者移除计算节点"></a>
### 动态添加或者移除计算节点

服务端要有能力把某些机器强行终止计算并且移除系统。同时，任何新开启的计算机应该可以随时连入系统并且进行计算


<a id="计算节点掉线任务重分配"></a>
### 计算节点掉线任务重分配

某个计算节点掉线之后应该有其他计算节点按照上次计算节点保存到服务器的状态继续开始计算。

<a id="计算暂停功能"></a>
### 计算暂停功能，要求能够在半个小时内终止计算（一个基本的计算迭代可能要数小时）

如果因为某些原因导致计算不得不提前暂停，应该能在半个小时以内保存完整的计算的临时的状态，并且损失的计算结果要尽可能的少。

<a id="断点继续计算"></a>
### 断点继续计算，服务器上保存断点的计算任务

这个地方和掉线重新分配其实本质是一样的。不说了，服务端可以控制暂停计算的网络继续计算。

<a id="计算节点状态监控"></a>
### 计算节点状态监控

在服务端可以监控计算节点的状态，并且应该包含当前计算机上CPU、内存、活动的计算进程数、其他进程数等详细信息。CPU和内存的状态应该含有数分钟内的历史记录，以绘制图表。


<a id="计算节点统一执行脚本"></a>
### 计算节点统一执行脚本

可以在服务端上发送命令后网络的所有计算节点统一执行某些shell命令。有的时候可能会涉及某些UAC权限命令，不过由于计算节点是以UAC管理员权限运行， 不用担心。此外，命令的执行结果必须统计回服务端，可以在WEB管理界面中看到命令的执行状态以及结果，命令也要有执行时限，执行ping -t之类的是不应该无限执行下去的。

<a id="邮件提醒"></a>
### 邮件提醒

在出现重大问题的时候发送邮件提醒，比如计算完成，掉线的机器超过某阈值，服务器的负载超过某些阈值之类的，阈值应该在管理面可以设置。邮箱也应该可以设置。


<a id="WEB管理界面"></a>
### WEB管理界面

不说啥了，你也不会前端，不过最基本的模板还是你先写好，不管好不好看。美观的事情我来管好了


<a id="数据表格导出"></a>
### 数据表格导出

WEB管理显示的计算结果的统计表可以导出，为了方便，CSV就好。

<a id="权值压缩打包下载"></a>
### 权值压缩打包下载

字面意义，打包下载

## 开发要求

使用Git进行版本管理，每完成一个功能都要有提交，每次提交要写清楚提交理由以及做出的更改。项目托管在Github上面。开发的时候在另外单独的分支，必要的时候由我来整合到Master分支。

开发周期由于现在并不着急，暂时定为不超过一个半月。